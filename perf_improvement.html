

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Performance Analysis &mdash; Impunity 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contribute to impunity" href="contribute.html" />
    <link rel="prev" title="How Does It Work ?" href="how.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Impunity
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Getting started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Annotations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="string_annotation.html">String Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotated.html">The Annotated object</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topic</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="how.html">How Does It Work ?</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Performance Analysis</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute to impunity</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Impunity</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Performance Analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/perf_improvement.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="performance-analysis">
<h1>Performance Analysis<a class="headerlink" href="#performance-analysis" title="Link to this heading"></a></h1>
<p>Python-enclined scientists do not use any Units of Measures (UoM) checking
library with the computation overhead they often induce during execution.
Python is a dynamic language, and most tools provide dynamic checking of
the UoM, every time a function is called with potentially different
parameters and different units of measures.</p>
<p>impunity statically checks the UoM of variables in the code based on
annotations and modifies the AST at definition time. We show in the
following that impunity is a lot quicker than four existing libraries,
chosen among other Python libraries dealing with UoM for their support,
regular updates and community.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/sbyrnes321/numericalunits/">numericalunits</a> uses
a complete set of independent base units (meters, kilograms, seconds,
coulombs, kelvins) that are defined as <em>randomly-chosen positive
floating-point</em> numbers, different for all executions. If units are consistent,
the randomness disappears; if not, two executions of the same code return
different values. All other units and constants are defined in terms of
those. In a dimensionally-correct calculation, the units all cancel out,
so the final answer is deterministic, not random. In a dimensionally-incorrect
calculations, there will be random factors causing a randomly-varying
final answer.</p></li>
<li><p><a class="reference external" href="https://www.astropy.org/">astropy</a>
is a Python package offering functionalities aimed at astronomers
and astrophysicists. It also includes an implementation of the
quantity design pattern. astropy also implements a decorator to check
calls of functions with quantity parameters.</p></li>
<li><p><a class="reference external" href="https://github.com/hgrecco/pint/">Pint</a>
also provides an implementation of the quantity
design pattern as a standalone library. It is
flexible and provides good integration with other
scientific libraries like Pandas (through extension types) or NumPy.</p></li>
<li><p><a class="reference external" href="https://github.com/python-quantities/python-quantities">Quantities</a>
is designed to handle arithmetic and conversions of physical quantities,
which have a magnitude, dimensionality specified by various units,
and possibly an uncertainty. Quantities builds on the popular NumPy
library and is designed to work with NumPy’s standard ufuncs,
many of which are already supported.</p></li>
</ul>
<p>For each library, two different use-cases are considered based on the example
<em>speed</em> function. One with variables annotated with the correct units
(meters and seconds), and one with different but commensurable units (meters
and hours). In both cases, two NumPy arrays of shape (10000,) are sent as
parameters. The computation time over 300 iterations is then averaged.
Execution times for both use-cases are displayed here :</p>
<figure class="align-default" id="my-custom-label">
<img alt="_images/impunity_performance.svg" src="_images/impunity_performance.svg" />
</figure>
<p>As we can see, the overhead induced by impunity is minimal.
This is mainly due to the difference between the dynamic
checking of the other libraries and the static analysis
done by impunity. By changing the AST directly before execution,
impunity limits its overhead to the multiplications added to keep
the units coherent between each others. This is also why, when
UoM are identical, the overhead is non-existent.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="how.html" class="btn btn-neutral float-left" title="How Does It Work ?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="contribute.html" class="btn btn-neutral float-right" title="Contribute to impunity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Antoine Chevrot.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>